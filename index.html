<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NERO DEWAR</title>

<style>
:root{
  /* Paper background */
  --bg:#ffffff;
  --surface:#f7fbff;
  --text:#0b1a2b;
  --muted:#6b7c93;

  /* CRAYON / NEON BLUE */
  --accent:#00A7FF;
  --accentHi:#5ED6FF;
  --border:#9EDCFF;

  --shadow:0 12px 30px rgba(0,80,140,.10);
  --glow:0 0 24px rgba(0,167,255,.30);
}

*{box-sizing:border-box}
body{
  margin:0;
  background:
    radial-gradient(900px 520px at 50% -10%, rgba(0,167,255,.10), transparent 60%),
    radial-gradient(700px 420px at 20% 0%, rgba(94,214,255,.10), transparent 60%),
    linear-gradient(#ffffff, #ffffff);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
}

/* Paper-ish grain (pure CSS, no external files) */
body::before{
  content:"";
  position:fixed; inset:0;
  pointer-events:none;
  opacity:.20;
  background:
    radial-gradient(circle at 12% 18%, rgba(0,0,0,.03) 0 1px, transparent 2px),
    radial-gradient(circle at 62% 72%, rgba(0,0,0,.025) 0 1px, transparent 2px),
    radial-gradient(circle at 82% 28%, rgba(0,0,0,.02) 0 1px, transparent 2px),
    radial-gradient(circle at 32% 86%, rgba(0,0,0,.02) 0 1px, transparent 2px);
  background-size: 160px 160px, 220px 220px, 180px 180px, 260px 260px;
  mix-blend-mode:multiply;
}

/* Header */
header{
  position:sticky;
  top:0;
  z-index:30;
  background:rgba(255,255,255,.88);
  backdrop-filter:blur(12px);
  border-bottom:2px solid rgba(158,220,255,.85);
}
.wrap{max-width:1180px;margin:0 auto;padding:22px}

/* Nero marker-ish title (now neon crayon blue) */
.logo{
  font-weight:1000;
  font-size:clamp(40px,6vw,78px);
  color:var(--accent);
  text-transform:uppercase;
  letter-spacing:1px;
  text-shadow:
    2px 0 rgba(0,120,255,.20),
   -2px 0 rgba(94,214,255,.25),
    0 0 24px rgba(0,167,255,.28);
}

/* Make title clickable */
.logo-btn{
  cursor:pointer;
  user-select:none;
  display:inline-block;
}
.logo-btn:hover{opacity:.9}

/* Scenes */
.scene{display:none}
.scene.active{display:block}

/* Album grid */
.album-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:18px;
}
.album-card{
  cursor:pointer;
  border-radius:18px;
  overflow:hidden;
  background:#fff;
  border:2px solid rgba(158,220,255,.90);
  box-shadow:var(--shadow);
  transition:.15s;
}
.album-card:hover{
  transform:translateY(-3px);
  box-shadow:var(--shadow),var(--glow);
}
.album-card img{
  width:100%;
  aspect-ratio:1/1;
  object-fit:cover;
  display:block;
}
.album-meta{
  padding:12px;
  font-weight:900;
  font-size:14px;
}

/* Album scene header */
.release-head{
  display:flex;
  align-items:center;
  gap:20px;
  margin-bottom:18px;
}
.release-cover{
  width:140px;
  height:140px;
  border-radius:18px;
  object-fit:cover;
  border:2px solid rgba(158,220,255,.90);
  box-shadow:0 0 26px rgba(0,167,255,.20);
}
.release-title{
  font-size:28px;
  font-weight:1000;
}
.release-meta{
  color:var(--muted);
  margin-top:6px;
}

/* Tracks */
.track{
  display:flex;
  align-items:center;
  gap:16px;
  padding:14px 0;
  border-top:1px dashed rgba(158,220,255,.85);
}
.track-art{
  width:56px;
  height:56px;
  border-radius:14px;
  object-fit:cover;
  border:2px solid rgba(158,220,255,.90);
  box-shadow:0 0 18px rgba(0,167,255,.10);
  flex:0 0 auto;
}
.track-title{
  font-weight:900;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  max-width:70ch;
}
.track-title a{
  color:var(--text);
  text-decoration:none;
  border-bottom:2px dotted rgba(0,167,255,.55);
}
.track-title a:hover{border-bottom-color:rgba(0,167,255,.95)}
.track button{
  margin-left:auto;
  padding:10px 18px;
  border-radius:16px;
  background:rgba(0,167,255,.12);
  border:2px solid rgba(0,167,255,.70);
  color:var(--text);
  cursor:pointer;
  font-weight:800;
}
.track button:hover{background:rgba(0,167,255,.22)}
.track button:disabled{opacity:.45;cursor:not-allowed}

/* More releases rail */
.more-rail{
  margin-top:36px;
  padding-top:20px;
  border-top:1px dashed rgba(158,220,255,.85);
}
.more-title{
  color:var(--muted);
  font-size:13px;
  text-transform:uppercase;
  margin-bottom:10px;
  letter-spacing:.8px;
}
.more-grid{
  display:flex;
  gap:14px;
  overflow-x:auto;
  padding-bottom:6px;
}
.more-grid .tile{
  width:120px;
  flex:0 0 auto;
  cursor:pointer;
}
.more-grid img{
  width:120px;
  height:120px;
  border-radius:16px;
  object-fit:cover;
  border:2px solid rgba(158,220,255,.85);
  box-shadow:0 0 18px rgba(0,80,140,.10);
}
.more-grid .cap{
  margin-top:8px;
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* About Me (Home screen only) */
.about-card{
  margin-top:20px;
  padding:16px;
  border-radius:18px;
  border:2px solid rgba(158,220,255,.90);
  background:linear-gradient(180deg, rgba(247,251,255,.95), rgba(255,255,255,.95));
  box-shadow:var(--shadow),0 0 18px rgba(0,167,255,.10);
}
.about-label{
  color:var(--muted);
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:.9px;
  margin:0 0 10px;
}
.about-text{
  margin:0;
  line-height:1.55;
  font-size:14px;
  max-width:75ch;
}
.about-text strong{
  color:var(--accent);
  font-weight:1000;
}

/* ===== PLAYER ===== */
.player{
  position:sticky;
  bottom:0;
  z-index:40;
  background:rgba(255,255,255,.92);
  border-top:2px solid rgba(158,220,255,.90);
  backdrop-filter:blur(16px);
  box-shadow:0 -18px 40px rgba(0,80,140,.10);
}
.player-inner{
  max-width:1180px;
  margin:0 auto;
  padding:14px 22px;
  display:flex;
  align-items:center;
  gap:16px;
}

/* Left artwork tile */
.player-art{
  width:64px;
  height:64px;
  border-radius:18px;
  object-fit:cover;
  border:2px solid rgba(158,220,255,.90);
  box-shadow:
    0 0 16px rgba(0,167,255,.10),
    0 10px 24px rgba(0,80,140,.10);
  flex:0 0 auto;
}

/* Title/artist stack */
.player-meta{
  display:flex;
  flex-direction:column;
  gap:4px;
  min-width:0;
  flex:1;
}
.player-title{
  font-weight:1000;
  font-size:22px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.player-artist{
  color:var(--muted);
  font-size:14px;
  letter-spacing:.6px;
  text-transform:uppercase;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

/* Controls cluster (right) */
.player-controls{
  display:flex;
  align-items:center;
  gap:18px;
  flex:0 0 auto;
}
.pbtn{
  width:78px;
  height:78px;
  border-radius:26px;
  border:2px solid rgba(0,167,255,.65);
  background:rgba(0,167,255,.10);
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:
    0 0 18px rgba(0,167,255,.12),
    inset 0 0 0 1px rgba(255,255,255,.25);
  transition: transform .10s ease, background .2s ease, border-color .2s ease;
}
.pbtn:hover{
  transform:translateY(-1px);
  background:rgba(0,167,255,.18);
  border-color:rgba(0,167,255,.90);
}
.pbtn:active{transform:translateY(0px)}
.pbtn:disabled{opacity:.45;cursor:not-allowed;transform:none}
.pbtn.primary{
  width:92px;
  height:92px;
  border-radius:30px;
  border-color:rgba(0,167,255,.90);
  box-shadow:
    0 0 26px rgba(0,167,255,.18),
    inset 0 0 0 1px rgba(255,255,255,.25);
}
.icon{
  width:30px;
  height:30px;
  color:var(--accent);
  filter:
    drop-shadow(1px 0 0 rgba(94,214,255,.25))
    drop-shadow(-1px 0 0 rgba(0,120,255,.18))
    drop-shadow(0 0 10px rgba(0,167,255,.18));
  opacity:.95;
}

/* Progress under player */
.player-progress{
  max-width:1180px;
  margin:0 auto;
  padding: 0 22px 12px;
}
.bar{
  height:10px;
  border-radius:999px;
  background:rgba(158,220,255,.35);
  border:2px solid rgba(158,220,255,.75);
  overflow:hidden;
  cursor:pointer;
}
.bar-fill{
  height:100%;
  width:0%;
  background:linear-gradient(to right, rgba(0,167,255,.90), rgba(94,214,255,.95));
  box-shadow:0 0 14px rgba(0,167,255,.18);
}
.time{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
  color:var(--muted);
  font-size:12px;
  font-variant-numeric:tabular-nums;
}

audio{display:none}

/* Footer */
footer{
  text-align:center;
  color:var(--muted);
  font-size:12px;
  padding:28px 0 140px;
}

/* Mobile */
@media (max-width: 820px){
  .player-title{font-size:18px}
  .pbtn{width:66px;height:66px;border-radius:22px}
  .pbtn.primary{width:78px;height:78px;border-radius:26px}
  .icon{width:26px;height:26px}
}
</style>
</head>

<body>
<header>
  <div class="wrap" style="display:flex;align-items:flex-end;gap:20px">
    <!-- Title is now HOME button -->
    <div id="titleHomeBtn" class="logo logo-btn" title="Home">NERO DEWAR</div>
  </div>
</header>

<main class="wrap">
  <!-- CATALOGUE SCENE -->
  <section id="catalogueScene" class="scene active">
    <div id="albumGrid" class="album-grid"></div>

    <!-- About Me (Home only) -->
    <div class="about-card">
      <div class="about-label">About</div>
      <p class="about-text">
        <strong>Nero Dewar</strong>, also known as <strong>James Ritchie</strong>, is a record producer and vocalist from
        <strong>South London</strong>. His enigmatic profile makes him one of the most diverse and prolific music producers
        in the world. In <strong>2025</strong>, he released <strong>10 albums</strong> and over <strong>120 songs</strong>.
        Visit his SoundCloud or Spotify for more…
      </p>
    </div>

    <footer>Copyright © 2026 James Ritchie. All rights reserved.</footer>
  </section>

  <!-- ALBUM SCENE -->
  <section id="albumScene" class="scene">
    <div class="release-head">
      <img id="releaseCover" class="release-cover" alt="">
      <div style="min-width:0;">
        <div id="releaseTitle" class="release-title"></div>
        <div id="releaseMeta" class="release-meta"></div>
      </div>
    </div>

    <div id="trackList"></div>

    <div class="more-rail">
      <div class="more-title">More Releases</div>
      <div id="moreAlbums" class="more-grid"></div>
    </div>
  </section>
</main>

<!-- PLAYER -->
<div class="player" role="region" aria-label="Audio player">
  <div class="player-inner">
    <img id="playerArt" class="player-art" alt="">
    <div class="player-meta">
      <div id="playerTitle" class="player-title">Select a track</div>
      <div id="playerArtist" class="player-artist">NERO DEWAR</div>
    </div>

    <div class="player-controls">
      <button id="prevBtn" class="pbtn" type="button" title="Previous" aria-label="Previous" disabled>
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M6 6h2v12H6V6zm12.5.8-8.5 5.2 8.5 5.2V6.8z"/>
        </svg>
      </button>

      <button id="playBtn" class="pbtn primary" type="button" title="Play/Pause" aria-label="Play/Pause">
        <svg id="playIcon" class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M8 5v14l11-7-11-7z"/>
        </svg>
        <svg id="pauseIcon" class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="display:none;">
          <path d="M7 6h4v12H7V6zm6 0h4v12h-4V6z"/>
        </svg>
      </button>

      <button id="nextBtn" class="pbtn" type="button" title="Next" aria-label="Next" disabled>
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M16 6h2v12h-2V6zM5.5 6.8v10.4l8.5-5.2-8.5-5.2z"/>
        </svg>
      </button>
    </div>

    <audio id="audio" preload="none"></audio>
  </div>

  <div class="player-progress">
    <div id="bar" class="bar" title="Seek">
      <div id="barFill" class="bar-fill"></div>
    </div>
    <div class="time">
      <span id="curTime">0:00</span>
      <span id="durTime">0:00</span>
    </div>
  </div>
</div>

<script>
let albums = [];
let tracks = [];
let queue = [];
let idx = -1;

const albumGrid = document.getElementById("albumGrid");
const trackList = document.getElementById("trackList");
const moreAlbums = document.getElementById("moreAlbums");

const catalogueScene = document.getElementById("catalogueScene");
const albumScene = document.getElementById("albumScene");

const titleHomeBtn = document.getElementById("titleHomeBtn");

const releaseCover = document.getElementById("releaseCover");
const releaseTitle = document.getElementById("releaseTitle");
const releaseMeta = document.getElementById("releaseMeta");

const audio = document.getElementById("audio");
const playerArt = document.getElementById("playerArt");
const playerTitle = document.getElementById("playerTitle");
const playerArtist = document.getElementById("playerArtist");

const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const playBtn = document.getElementById("playBtn");
const playIcon = document.getElementById("playIcon");
const pauseIcon = document.getElementById("pauseIcon");

const bar = document.getElementById("bar");
const barFill = document.getElementById("barFill");
const curTimeEl = document.getElementById("curTime");
const durTimeEl = document.getElementById("durTime");

function show(scene){
  catalogueScene.classList.remove("active");
  albumScene.classList.remove("active");
  scene.classList.add("active");
}

function goHome(){
  show(catalogueScene);
  history.replaceState(null, "", "#");
}

titleHomeBtn.addEventListener("click", goHome);

function formatTime(sec){
  if (!isFinite(sec) || sec < 0) sec = 0;
  const m = Math.floor(sec / 60);
  const s = Math.floor(sec % 60);
  return `${m}:${String(s).padStart(2,"0")}`;
}

function setPlayUI(isPlaying){
  playIcon.style.display = isPlaying ? "none" : "block";
  pauseIcon.style.display = isPlaying ? "block" : "none";
}

function getAlbum(id){
  return albums.find(a => a.id === id) || null;
}

function renderCatalogue(){
  albumGrid.innerHTML = albums.map(a => `
    <div class="album-card" onclick="openAlbum('${a.id}')">
      <img src="${a.artwork}" alt="${a.title} cover" loading="lazy">
      <div class="album-meta">${a.title}</div>
    </div>
  `).join("");
}

function openAlbum(id){
  const album = getAlbum(id);
  if (!album) return;

  show(albumScene);
  history.replaceState(null, "", `#release=${encodeURIComponent(id)}`);

  releaseCover.src = album.artwork;
  releaseCover.alt = `${album.title} cover`;
  releaseTitle.textContent = album.title;
  releaseMeta.textContent = `${album.releaseDate} • ${album.genre}`;

  queue = tracks
    .filter(t => t.albumId === id)
    .slice()
    .sort((a,b) => (a.trackNumber||0) - (b.trackNumber||0));

  trackList.innerHTML = queue.map((t, i) => {
    const art = t.artwork || album.artwork;
    const src = t.src || "";
    const title = t.title || `Track ${t.trackNumber || ""}`;
    const disabled = !src;
    return `
      <div class="track">
        <img class="track-art" src="${art}" alt="${title} artwork" loading="lazy">
        <div class="track-title">
          ${String(t.trackNumber || 0).padStart(2,"0")} —
          ${src ? `<a href="${src}" target="_blank" rel="noopener">${title}</a>` : `<span>${title}</span>`}
        </div>
        <button ${disabled ? "disabled" : ""} onclick="playFromQueue(${i})">Play</button>
      </div>
    `;
  }).join("");

  moreAlbums.innerHTML = albums
    .filter(a => a.id !== id)
    .map(a => `
      <div class="tile" onclick="openAlbum('${a.id}')">
        <img src="${a.artwork}" alt="${a.title} cover" loading="lazy">
        <div class="cap">${a.title}</div>
      </div>
    `).join("");
}

window.openAlbum = openAlbum;

function setPlayerMeta(track){
  const album = getAlbum(track.albumId);
  const art = track.artwork || album?.artwork || "";
  playerArt.src = art;
  playerArt.alt = track.title ? `${track.title} artwork` : "";
  playerTitle.textContent = track.title || "Select a track";
  playerArtist.textContent = "NERO DEWAR";
}

function updatePrevNextDisabled(){
  prevBtn.disabled = !(idx > 0);
  nextBtn.disabled = !(idx >= 0 && idx < queue.length - 1);
}

function playFromQueue(i){
  idx = i;
  const t = queue[idx];
  if (!t || !t.src) return;

  audio.src = t.src;
  audio.play().catch(()=>{});
  setPlayerMeta(t);

  history.replaceState(null, "", `#release=${encodeURIComponent(t.albumId)}&track=${encodeURIComponent(t.id)}`);
  updatePrevNextDisabled();
}
window.playFromQueue = playFromQueue;

function togglePlay(){
  if (!audio.src){
    const first = queue.findIndex(x => x.src);
    if (first >= 0) playFromQueue(first);
    return;
  }
  if (audio.paused) audio.play().catch(()=>{});
  else audio.pause();
}

prevBtn.onclick = () => { if (idx > 0) playFromQueue(idx - 1); };
nextBtn.onclick = () => { if (idx < queue.length - 1) playFromQueue(idx + 1); };
playBtn.onclick = togglePlay;

audio.addEventListener("play", () => setPlayUI(true));
audio.addEventListener("pause", () => setPlayUI(false));
audio.addEventListener("ended", () => { if (idx < queue.length - 1) playFromQueue(idx + 1); });

audio.addEventListener("timeupdate", () => {
  const cur = audio.currentTime || 0;
  const dur = audio.duration || 0;
  const pct = dur ? (cur / dur) * 100 : 0;
  barFill.style.width = `${pct}%`;
  curTimeEl.textContent = formatTime(cur);
  durTimeEl.textContent = formatTime(dur);
});

bar.addEventListener("click", (e) => {
  if (!isFinite(audio.duration) || audio.duration <= 0) return;
  const rect = bar.getBoundingClientRect();
  const x = Math.min(Math.max(0, e.clientX - rect.left), rect.width);
  const pct = rect.width ? (x / rect.width) : 0;
  audio.currentTime = pct * audio.duration;
});

function parseHash(){
  const raw = (location.hash || "").replace(/^#/, "");
  return new URLSearchParams(raw);
}

window.addEventListener("hashchange", () => {
  const p = parseHash();
  const rel = p.get("release");
  const trk = p.get("track");

  if (!rel){
    goHome();
    return;
  }

  openAlbum(rel);

  if (trk){
    const i = queue.findIndex(t => t.id === trk);
    if (i >= 0) playFromQueue(i);
  }
});

(async function init(){
  albums = await fetch("data/albums.json", { cache: "no-store" }).then(r => r.json());
  tracks = await fetch("data/tracks.json", { cache: "no-store" }).then(r => r.json());

  renderCatalogue();

  // Initialize player with a safe artwork
  playerArt.src = albums[0]?.artwork || "";
  playerArt.alt = "";
  playerTitle.textContent = "Select a track";
  playerArtist.textContent = "NERO DEWAR";
  setPlayUI(false);
  updatePrevNextDisabled();

  const p = parseHash();
  const rel = p.get("release");
  const trk = p.get("track");
  if (rel){
    openAlbum(rel);
    if (trk){
      const i = queue.findIndex(t => t.id === trk);
      if (i >= 0) playFromQueue(i);
    }
  } else {
    goHome();
  }
})();
</script>
</body>
</html>
